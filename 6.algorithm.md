# æ ‡å‡†ä¸­çš„ç®—æ³•

ç¨‹åºå‘˜æ˜¯ä¸€ä¸ªç—´è¿·äºâ€œåº•å±‚æœºç†â€çš„ç¾¤ä½“ã€‚ä»–ä»¬å–œæ¬¢é€šè¿‡é€ è½®å­åƒé€åº•å±‚åŸç†ï¼›é‚£äº›æ ‡é¢˜å¸¦æœ‰â€œåº•å±‚â€äºŒå­—çš„æŠ€æœ¯æ–‡ç« ä¹Ÿå¸¸å¸¸ä¼šæœ‰ä¸é”™çš„åå“ï¼›è€Œé¢è¯•å®˜ï¼Œå†·ä¸ä¸å°±ä¼šè®©ä½ æ‰‹å†™ä¸ªä»€ä¹ˆä¸œè¥¿ã€‚

å¯¹æˆ‘æ¥è¯´ï¼Œäº†è§£JavaScriptçš„åº•å±‚åŸç†ï¼Œåªæœ‰ä¸¤ä¸ªé è°±çš„æ¸ é“ï¼šä¸€æ˜¯é˜…è¯»Jså¼•æ“æºç ï¼Œå¦ä¸€ä¸ªæ˜¯é˜…è¯»ECMAScriptæ ‡å‡†ä¸­çš„ç®—æ³•ã€‚è€Œå…¶ä»–çš„èµ„æ–™ï¼Œç»Ÿç»Ÿä¸é è°±ï¼Œæˆ–è€…è‡³å°‘è¿œè¿œä¸å¦‚è¿™ä¸¤ä¸ªèµ„æ–™æºé è°±ã€‚

å°±åƒæˆ‘åœ¨[18.promise](./18.promise.md)ä¸ºä½ å±•ç¤ºçš„ä¸€æ ·ï¼Œæˆ‘åŸºäºæ ‡å‡†[å®šä¹‰Promiseå¯¹è±¡](https://tc39.es/ecma262/multipage/control-abstraction-objects.html#sec-promise-objects)çš„ç« èŠ‚ï¼Œé€ äº†ä¸€ä¸ªPromiseçš„â€œè½®å­â€ï¼Œè¿™ä¸ªè½®å­é€šè¿‡äº†test262æ ‡å‡†ç¬¦åˆæ€§æµ‹è¯•ï¼Œè¯•é—®ï¼šå“ªä¸€ç¯‡æŠ€æœ¯æ–‡ç« ï¼Œåˆæˆ–è€…å“ªä¸€æœ¬æŠ€æœ¯ä¹¦èƒ½å¤Ÿè®©ä½ åšåˆ°è¿™ä¸ªç¨‹åº¦ï¼Ÿ

é™¤äº†Promiseå¯¹è±¡ï¼Œä¸€äº›å¸¸å¸¸è¢«æ‹¿å‡ºæ¥è®¨è®ºçš„åº•å±‚ç®—æ³•ï¼Œä¹Ÿæ˜¯æ˜æ™ƒæ™ƒçš„æ”¾åœ¨æ ‡å‡†å½“ä¸­ï¼š

> - [å¯¹è±¡çš„æ‹†ç®±è½¬æ¢](https://tc39.es/ecma262/multipage/abstract-operations.html#sec-ordinarytoprimitive)
> - [instanceæ“ä½œç¬¦çš„åŸç†](https://tc39.es/ecma262/multipage/ecmascript-language-expressions.html#sec-instanceofoperator)
> - [newè¡¨è¾¾å¼çš„åŸç†](https://tc39.es/ecma262/multipage/ordinary-and-exotic-objects-behaviours.html#sec-ecmascript-function-objects-construct-argumentslist-newtarget)
> - å‡½æ•°çš„[apply](https://tc39.es/ecma262/multipage/fundamental-objects.html#sec-function.prototype.apply)ã€[bind](https://tc39.es/ecma262/multipage/fundamental-objects.html#sec-function.prototype.bind)ã€[call](https://tc39.es/ecma262/multipage/fundamental-objects.html#sec-function.prototype.call)æ–¹æ³•çš„åŸç†
> - ...
>

å½“ç„¶ï¼Œè¦è¯»æ‡‚è¿™äº›ç®—æ³•ï¼Œä¹Ÿä¸æ˜¯æ²¡æœ‰é—¨æ§›çš„ã€‚é¦–å…ˆï¼Œä½ å¾—äº†è§£ç®—æ³•æœ‰ä»€ä¹ˆç±»å‹ï¼Œä¸åŒçš„ç±»å‹æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Œè¿™æ ·ä½ æ‰èƒ½çŸ¥é“è¿™ä¸ªç®—æ³•ä¼šåœ¨ä»€ä¹ˆæ—¶å€™è¢«è°ƒç”¨ï¼›å…¶æ¬¡ï¼Œä¸ºäº†å‡å°‘å†—ä½™ï¼Œæ ‡å‡†çš„ç®—æ³•ä½¿ç”¨äº†å¤§é‡çš„ç¬¦å·ä»£æ›¿æ–‡å­—è¿›è¡Œè¡¨è¿°ï¼Œæ‰€ä»¥ä½ å¿…é¡»äº†è§£è¿™äº›ç¬¦å·çš„å…·ä½“å«ä¹‰ï¼›æœ€åï¼Œä½ å¿…é¡»è¦æœ‰è¶³å¤Ÿçš„åŸºç¡€æ¦‚å¿µçš„ç§¯ç´¯ï¼Œå› ä¸ºç®—æ³•ä¸­å¸¸å¸¸ä¼šå¤§é‡å¼•ç”¨å…¶ä»–ç¯‡ç« çš„æ¦‚å¿µï¼Œå¦‚æœè¿™äº›åŸºç¡€æ¦‚å¿µç¼ºå¤±å¤ªå¤šï¼Œä½ å°±ä¼šæ„Ÿè§‰è‡ªå·±åœ¨è¯»ä¸€ç¯‡å¾ˆå¤šç”Ÿè¯çš„æ–‡ç« ï¼Œç†è§£èµ·æ¥éå¸¸åƒåŠ›ã€‚

æœ¬èŠ‚ä¼šå¸®ä½ è§£å†³å‰ä¸¤ä¸ªé—®é¢˜ï¼Œå³ç®—æ³•çš„åˆ†ç±»ä»¥åŠç®—æ³•çš„ç¬¦å·è¡¨ç¤ºï¼›è€Œç¬¬ä¸‰ä¸ªé—®é¢˜ï¼Œæ˜¯è¿™æ•´æœ¬ä¹¦è¦å¸®ä½ è§£å†³çš„é—®é¢˜ã€‚

æ ‡å‡†çš„ç®—æ³•å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šä¸€ç±»æ˜¯**æŠ½è±¡æ“ä½œï¼ˆabstract operationsï¼‰** ï¼Œå¦ä¸€ç±»æ˜¯**è¯­æ³•å¯¼å‘æ“ä½œï¼ˆsyntax-directed operationï¼‰** ã€‚æœ¬èŠ‚æˆ‘ä¼šå…ˆè®²è¾ƒä¸ºç®€å•çš„æŠ½è±¡æ“ä½œï¼Œç„¶åå†è®²è¯­æ³•å¯¼å‘æ“ä½œï¼Œæœ€åï¼Œæˆ‘ä¼šè®²è¿™ä¸¤ç±»ç®—æ³•çš„è¡¨ç¤ºçº¦å®šã€‚


<br/>


### ç›®å½•:

- [æŠ½è±¡æ“ä½œ](#æŠ½è±¡æ“ä½œ)

- [è¯­æ³•å¯¼å‘æ“ä½œ](#è¯­æ³•å¯¼å‘æ“ä½œ)

  * [è¿è¡Œæ—¶è¯­ä¹‰](#è¿è¡Œæ—¶è¯­ä¹‰)

  * [é™æ€è¯­ä¹‰](#é™æ€è¯­ä¹‰)

  * [é“¾å¼äº§ç”Ÿå¼çš„è¯­æ³•å¯¼å‘æ“ä½œ](#é“¾å¼äº§ç”Ÿå¼çš„è¯­æ³•å¯¼å‘æ“ä½œ)

- [ç®—æ³•çš„è¡¨ç¤ºçº¦å®š](#ç®—æ³•çš„è¡¨ç¤ºçº¦å®š)

  * [ç®—æ³•ä¸­çš„æ•°å­—](#ç®—æ³•ä¸­çš„æ•°å­—)

  * [ç®—æ³•ä¸­çš„è§„èŒƒç±»å‹](#ç®—æ³•ä¸­çš„è§„èŒƒç±»å‹)
<br/>


## æŠ½è±¡æ“ä½œ

**ã€ŒæŠ½è±¡æ“ä½œã€æ˜¯é‚£äº›å¯ä»¥è¢«å¤ç”¨çš„é€»è¾‘ï¼Œç›¸å½“äºæ™®é€šå‡½æ•°ã€‚** 

å¸¸è§çš„æŠ½è±¡æ“ä½œåœ¨æ ‡å‡†çš„[ç¬¬7ç« ](https://tc39.es/ecma262/#sec-abstract-operations)å®šä¹‰ï¼ŒåŒ…æ‹¬ï¼š

- [7.1 ç±»å‹è½¬æ¢ç›¸å…³çš„æŠ½è±¡æ“ä½œ](https://tc39.es/ecma262/#sec-type-conversion)
- [7.2 ç±»å‹åˆ¤æ–­ä¸æ•°å€¼æ¯”è¾ƒç›¸å…³çš„æŠ½è±¡æ“ä½œ](https://tc39.es/ecma262/#sec-testing-and-comparison-operations)
- [7.3 å¯¹è±¡ç›¸å…³çš„æŠ½è±¡æ“ä½œ](https://tc39.es/ecma262/#sec-operations-on-objects)
- [7.4 è¿­ä»£å™¨ç›¸å…³çš„æ“ä½œæ“ä½œ](https://tc39.es/ecma262/#sec-operations-on-iterator-objects)

æ¯”å¦‚ï¼Œå‰é¢æåˆ°çš„æ‹†ç®±è½¬æ¢ï¼Œæ ¸å¿ƒé€»è¾‘[OrdinaryToPrimitive](https://tc39.es/ecma262/multipage/abstract-operations.html#sec-ordinarytoprimitive)å°±æ˜¯ä¸€ä¸ªæŠ½è±¡æ“ä½œã€‚

![ordinary2primitive](assets/algorithm/ordinary2primitive.png)

è¿™ä¸ªç®—æ³•çš„æ„æ€å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š

> è¯¥æŠ½è±¡æ“ä½œä»¥ä¸€ä¸ª*O*ï¼ˆå¯¹è±¡ç±»å‹ï¼‰ä»¥åŠ*hint*ï¼ˆå€¼ä¸º"string"æˆ–"number"ï¼‰ä¸ºå‚æ•°ï¼ŒæˆåŠŸæ‰§è¡Œä¼šè¿”å›ä¸€ä¸ªECMAScriptè¯­è¨€ç±»å‹çš„å€¼ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼š
>
> 1. æ ¹æ®å‚æ•°*hint*å†³å®š`toString`ã€`valueOf`çš„è°ƒç”¨é¡ºåºï¼Œå¦‚æœhintä¸ºâ€œstringâ€å°±å…ˆè°ƒç”¨`tostring`ï¼›
> 2. å¦åˆ™å°±å…ˆè°ƒç”¨`valueof`ï¼›
> 3. æŒ‰ç…§å‰é¢å†³å®šçš„é¡ºåºä¾æ¬¡è°ƒç”¨å¯¹åº”æ–¹æ³•ï¼Œå½“æŸä¸ªæ–¹æ³•è¿”å›çš„å€¼ä¸æ˜¯å¯¹è±¡ç±»å‹ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥å€¼ï¼Œç®—æ³•ç»“æŸï¼›
> 4. å¦åˆ™ï¼Œå¦‚æœä¸¤ä¸ªæ–¹æ³•è¿”å›çš„éƒ½æ˜¯å¯¹è±¡ç±»å‹ï¼Œåˆ™æŠ›å‡ºTypeErrorçš„å¼‚å¸¸ã€‚

ï¼ˆå›¾ç‰‡ä¸­çš„`normal completion`ã€`throw completion`æ˜¯ä»€ä¹ˆæˆ‘ä¼šåœ¨[7.è§„èŒƒç±»å‹](./7.spec_type.md)ä¸­å†ç»†è¯´ã€‚ï¼‰

<br />

ä½ å¯ä»¥é€šè¿‡ç®—æ³•æ ‡é¢˜çš„äº¤å‰ç´¢å¼•æ‰¾åˆ°è¿™ä¸ªæŠ½è±¡æ“ä½œè¢«å¤ç”¨çš„åœ°æ–¹ï¼š

![ordinary2primitive-reference](assets/algorithm/ordinary2primitive-reference.png)

æ²¿ç€äº¤å‰ç´¢å¼•ï¼Œæˆ‘ä»¬åå‘è¿½è¸ªåˆ°`Number()`ä»¥åŠ`String()`éƒ½ä¼šä½¿ç”¨è¿™ä¸ªæŠ½è±¡æ“ä½œè¿›è¡Œç±»å‹è½¬æ¢ï¼Œè°ƒç”¨é“¾å¦‚ä¸‹æ‰€ç¤ºï¼š

> - [Number()](https://tc39.es/ecma262/multipage/numbers-and-dates.html#sec-number-constructor-number-value)-> [ToNumeric()](https://tc39.es/ecma262/multipage/abstract-operations.html#sec-tonumeric) -> [ToPrimitive()](https://tc39.es/ecma262/multipage/abstract-operations.html#sec-toprimitive) -> [OrdinaryToPrimitive()](https://tc39.es/ecma262/multipage/abstract-operations.html#sec-ordinarytoprimitive)ï¼›
> - [String()](https://tc39.es/ecma262/multipage/text-processing.html#sec-string-constructor-string-value) -> [ToString()](https://tc39.es/ecma262/multipage/abstract-operations.html#sec-tostring) -> [ToPrimitive()](https://tc39.es/ecma262/multipage/abstract-operations.html#sec-toprimitive) -> [OrdinaryToPrimitive()](https://tc39.es/ecma262/multipage/abstract-operations.html#sec-ordinarytoprimitive)ï¼›

äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹çš„ä»£ç æ¥éªŒè¯`OrdinaryToPrimitive()`çš„é€»è¾‘ï¼š

```js
// ä½¿valueOfã€toStringéƒ½è¿”å›å¯¹è±¡
const testObj = {
    "valueOf": () => {
        console.log('number')
        return {}
    },
    "toString": () => {
        console.log("string")
        return {}
    }  
}

Number(testObj) // æ­¤æ—¶hintä¸ºnumber
/* ä¾æ¬¡æ‰“å°ç»“æœï¼š
    1. number
    2. string
    3. æŠ¥é”™ï¼šUncaught TypeError: Cannot convert object to primitive value */

String(testObj) // æ­¤æ—¶hintä¸ºstring
/* ä¾æ¬¡æ‰“å°ç»“æœï¼š
    string
    number
    æŠ¥é”™ï¼šUncaught TypeError: Cannot convert object to primitive value */
```

<br />


<br/>


## è¯­æ³•å¯¼å‘æ“ä½œ

**å¦ä¸€å¤§ç±»ç®—æ³•ç§°ä¸ºã€Œè¯­æ³•å¯¼å‘æ“ä½œã€ï¼Œä¸æŠ½è±¡æ“ä½œä¸åŒçš„æ˜¯ï¼Œè¯­æ³•å¯¼å‘æ“ä½œä¸äº§ç”Ÿå¼ç»‘å®šï¼Œä½ å¯ä»¥ç†è§£ä¸ºç›®æ ‡ç¬¦å®ä¾‹ä¸Šçš„æ–¹æ³•ã€‚** 

è¿˜è®°å¾—æˆ‘ä»¬åœ¨[5.æ–‡æ³•æ±‡æ€»](./5.grammar-summary.md#è¯­æ³•è§£æçš„è¿‡ç¨‹)å¯¹â€œäººäººéƒ½èƒ½è¯»æ ‡å‡†â€è¿™å¥è¯è¿›è¡Œäº†è¯­æ³•è§£æå—ï¼Ÿæˆ‘ä»¬å¾—å‡ºè¿™æ˜¯ä¸€ä¸ªâ€œä¸»è°“å®¾â€ç»“æ„çš„å¥å­ï¼Œè€Œç‰¹å®šç»“æ„çš„å¥å­èƒ½å¤Ÿè¡¨è¾¾ç‰¹å®šçš„è¯­ä¹‰ã€‚æ¯”å¦‚ï¼Œâ€œä¸»è°“å®¾â€ç»“æ„çš„å¥å­ï¼Œä¸€èˆ¬ç”¨äºè¡¨è¾¾â€œä¸»ä½“â€å¯¹â€œå®¢ä½“â€åšäº†ä»€ä¹ˆï¼›åœ¨è¿™é‡Œï¼Œå³ï¼šæ‰€æœ‰ç¨‹åºå‘˜ï¼ˆä¸»ä½“ï¼‰éƒ½èƒ½å¤Ÿè¯»æ‡‚ECMAScriptæ ‡å‡†ï¼ˆå®¢ä½“ï¼‰ã€‚

è€Œç¼–ç¨‹è¯­è¨€å½“ç„¶ä¹Ÿæœ‰è‡ªå·±çš„è¯­ä¹‰ï¼ˆsemanticsï¼‰è¡¨è¾¾ã€‚åœ¨ç¨‹åºä¸­ï¼Œä¸€ä¸ªèµ‹å€¼è¯­å¥è¡¨è¾¾æƒ³è¦ä¸ºæŸä¸ªå˜é‡èµ‹äºˆæŸä¸ªå€¼ï¼›ä¸€ä¸ªå‡½æ•°å£°æ˜è¯­å¥è¡¨è¾¾æƒ³è¦åˆ›å»ºä¸€ä¸ªå«æœ‰ç‰¹å®šé€»è¾‘çš„å‡½æ•°ï¼›ä¸€ä¸ªå‡½æ•°è°ƒç”¨è¯­å¥è¡¨è¾¾æƒ³è¦æ‰§è¡ŒæŸä¸ªå‡½æ•°çš„é€»è¾‘ï¼›ä¸€ä¸ªthrowè¯­å¥è¡¨è¾¾æƒ³è¦æŠ›å‡ºæŸä¸ªé”™è¯¯......

**åœ¨ECMAScriptä¸­ï¼Œæ–‡æ³•åªç”¨äºå®šä¹‰è¯­å¥çš„ç»“æ„ã€‚è€Œä¸åŒç»“æ„çš„è¯­å¥ï¼Œå…¶è¯­ä¹‰é€šè¿‡ã€Œè¯­æ³•å¯¼å‘æ“ä½œã€è¿›è¡Œè¡¨è¾¾ã€‚ä¸€æ¡äº§ç”Ÿå¼å¯ä»¥ç»‘å®šå¤šæ¡è¯­æ³•å¯¼å‘æ“ä½œï¼Œå…¶å…·ä½“é€»è¾‘ç”±æ ‡å‡†å®šä¹‰ï¼›æ¯æ¡äº§ç”Ÿå¼çš„ç›®æ ‡ç¬¦å®ä¾‹éƒ½å¯ä»¥é€šè¿‡è°ƒç”¨å…¶è‡ªèº«çš„è¯­æ³•å¯¼å‘æ“ä½œï¼Œæ‰§è¡Œè¿™äº›é€»è¾‘ï¼Œä»è€Œå®Œæˆè¯­å¥è¯­ä¹‰çš„è¡¨è¾¾ã€‚** 

åœ¨æ ‡å‡†ä¸­ï¼Œè¯­æ³•å¯¼å‘æ“ä½œçš„é€»è¾‘ä¼šä»¥ç®—æ³•æ­¥éª¤çš„å½¢å¼ç›´æ¥å‡ºç°åœ¨äº§ç”Ÿå¼çš„ä¸‹æ–¹ã€‚æˆ‘ä»¬å…ˆä»¥ä¸€ä¸ª[å…¨æ ‡å‡†æœ€ç®€å•çš„è¯­æ³•å¯¼å‘æ“ä½œ](https://tc39.es/ecma262/multipage/ecmascript-language-scripts-and-modules.html#sec-script-semantics-runtime-semantics-evaluation)ä¸ºä¾‹ï¼š

![script-empty-producion](assets/algorithm/script-empty-producion.png)

è¿™é‡Œéœ€è¦æ³¨æ„çš„ç‚¹æœ‰ï¼š

- åœ¨è¯­æ³•å¯¼å‘æ“ä½œçš„åå­—ä¸­ï¼š
  - `:`å·¦è¾¹çš„éƒ¨åˆ†è¡¨ç¤ºè¯­æ³•å¯¼å‘æ“ä½œçš„ç±»å‹ã€‚åœ¨æ ‡å‡†ä¸­ï¼Œè¯­æ³•å¯¼å‘æ“ä½œå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š**è¿è¡Œæ—¶è¯­ä¹‰ï¼ˆRuntime Semanticsï¼‰** ä»¥åŠ**é™æ€è¯­ä¹‰ï¼ˆStatics Semanticsï¼‰** ï¼Œå®ƒä»¬çš„åŒºåˆ«æˆ‘ä»¬ä¼šåœ¨ä¸‹é¢è¯¦ç»†å±•å¼€ã€‚
  
  - `:`å³è¾¹çš„éƒ¨åˆ†æ˜¯è¯¥è¯­æ³•å¯¼å‘æ“ä½œçš„å…·ä½“åå­—ã€‚å½“åœ¨å…¶ä»–åœ°æ–¹éœ€è¦è°ƒç”¨è¿™ä¸ªè¯­æ³•å¯¼å‘æ“ä½œæ—¶ï¼Œä¼šä½¿ç”¨`(è¯­æ³•å¯¼å‘æ“ä½œå) ofï¼ˆç›®æ ‡ç¬¦ï¼‰`çš„æ ¼å¼ï¼Œæ¯”å¦‚ï¼Œè¿™é‡Œæ˜¯`Evaluation of Script`ã€‚ä¸‹å›¾æ˜¯ä¸€ä¸ª[å®é™…çš„ä¾‹å­](https://tc39.es/ecma262/multipage/ecmascript-language-scripts-and-modules.html#sec-runtime-semantics-scriptevaluation)ï¼š
  
    ![evaluaion-of-script](assets/algorithm/evaluaion-of-script.png)
  
- åŒä¸€ç›®æ ‡ç¬¦çš„ä¸åŒä»£æ¢å¼ä¸­ï¼Œè¯­æ³•å¯¼å‘æ“ä½œçš„å…·ä½“é€»è¾‘æœ‰å¯èƒ½ä¼šä¸åŒã€‚æ¯”å¦‚è¿™ä¸ªâ€œå…¨æ ‡å‡†æœ€ç®€å•çš„è¯­æ³•å¯¼å‘æ“ä½œâ€ï¼Œæ˜¯ç»‘å®šåœ¨ç›®æ ‡ç¬¦[Script](https://tc39.es/ecma262/multipage/ecmascript-language-scripts-and-modules.html#prod-Script)ä¸Šçš„ï¼Œé€»è¾‘éå¸¸ç®€å•ï¼Œå°±æ˜¯è¿”å›ä¸€ä¸ªundefinedã€‚ä½†å®ƒåªç»‘å®šåœ¨`Script:[empty]`è¿™æ¡ä»£æ¢å¼ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´åªé€‚ç”¨äºScriptä¸ºç©ºçš„æƒ…å†µï¼Œå½“Scriptä¸ä¸ºç©ºæ—¶ï¼Œè°ƒç”¨Evaluationè¯­æ³•å¯¼å‘æ“ä½œå¹¶ä¸ä¼šèµ°è¿™æ®µé€»è¾‘ã€‚


<br/>


### è¿è¡Œæ—¶è¯­ä¹‰

**ç±»å‹ä¸ºè¿è¡Œæ—¶è¯­ä¹‰çš„è¯­æ³•å¯¼å‘æ“ä½œï¼Œä¸€èˆ¬è¡¨ç¤ºè¯¥è¯­å¥èƒ½åšä»€ä¹ˆï¼Œä¸”åªä¼šåœ¨è¿è¡Œæ—¶è¢«è°ƒç”¨ã€‚** 

**æœ€å¸¸è§ã€æœ€é‡è¦çš„è¿è¡Œæ—¶è¯­ä¹‰å°±æ˜¯Evaluation â€”â€” æœ¬ä¹¦å°†ç»Ÿä¸€ç§°ä¸ºã€Œæ±‚å€¼è¯­ä¹‰ã€ã€‚æˆ‘ä»¬å¸¸è¯´çš„â€œæ‰§è¡ŒæŸä¸ªè¯­å¥â€ï¼Œç«™åœ¨æ ‡å‡†çš„è§’åº¦ï¼Œå°±æ˜¯è°ƒç”¨è¿™ä¸ªè¯­å¥çš„æ±‚å€¼è¯­ä¹‰ã€‚** 

æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨[5.æ–‡æ³•æ±‡æ€»](./5.grammar-summary.md#è¡¨è¾¾å¼)æåˆ°çš„ç»“æ„æœ€å¤§çš„è¡¨è¾¾å¼[Expression](https://tc39.es/ecma262/multipage/ecmascript-language-expressions.html#prod-Expression)ï¼Œå…¶æ±‚å€¼è¯­ä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š

![expression-evaluation](assets/algorithm/expression-evaluation.png)

æŠŠè¿™æ®µé€»è¾‘ç¿»è¯‘è¿‡æ¥å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š

> 1. è°ƒç”¨é€—å·å·¦è¾¹çš„è¡¨è¾¾å¼çš„æ±‚å€¼è¯­ä¹‰ï¼›
> 1. è·å–ç¬¬ä¸€æ­¥æ‰§è¡Œç»“æœçš„å€¼ï¼›
> 1. è°ƒç”¨é€—å·å³è¾¹çš„è¡¨è¾¾å¼çš„æ±‚å€¼è¯­ä¹‰ï¼›
> 1. è¿”å›ç¬¬ä¸‰æ­¥æ‰§è¡Œç»“æœçš„å€¼ã€‚

ï¼ˆå…³äºç®—æ³•ä¸­é—®å·`?`çš„å«ä¹‰ï¼Œä¼šåœ¨ä¸‹é¢[ç¬¦å·è¡¨ç¤ºçš„éƒ¨åˆ†](#ç®—æ³•ä¸­çš„è§„èŒƒç±»å‹)å†è§£é‡Šï¼‰

ç”±æ­¤æˆ‘ä»¬å¾—çŸ¥ï¼Œé€šè¿‡é€—å·åˆ†éš”çš„è¡¨è¾¾å¼ï¼Œä¼šè¿”å›æœ€åä¸€æ¡è¡¨è¾¾å¼çš„å€¼ï¼š

```js
console.log((1,2,3,4)) // 4
console.log((a = 1, b = 2)) // 2
console.log((c = 1, c++, -c)) // -2
```

æ­£å¦‚ç»¿è‰²çš„Noteæ‰€æç¤ºçš„ï¼Œå³ä¾¿é€—å·å·¦è¾¹çš„è¡¨è¾¾å¼ä¸ä¼šè¢«è¿”å›ï¼Œä½†ï¼ˆåœ¨ç¬¬äºŒæ­¥ï¼‰ä¹Ÿéœ€è¦æœ‰â€œè·å–è¡¨è¾¾å¼çš„å€¼â€è¿™ä¸ªåŠ¨ä½œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹çš„ä»£ç çœ‹åˆ°å®ƒæ‰€å¸¦æ¥çš„å‰¯ä½œç”¨ï¼š

```js
const a = {
    get b(){console.log("flag")} 
}
console.log((a.b, 1))
// flag
// 1
```

åˆç”±äºï¼Œè¿è¡Œæ—¶è¯­ä¹‰æ˜¯åœ¨éç»ˆç»“ç¬¦å®ä¾‹ä¸Šè§¦å‘çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…ç„¶å¯ä»¥ä»è§£ææ ‘çš„è§†è§’è§‚å¯Ÿè¿è¡Œæ—¶è¯­ä¹‰çš„è°ƒç”¨è¿‡ç¨‹ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ¡è¡¨è¾¾å¼ï¼š

```js
c = 1, c++, -c
```

é€šè¿‡å¯¹è¿™æ¡è¡¨è¾¾å¼è¿›è¡Œè¯­æ³•è§£ææˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‹å›¾å·¦ä¾§è¿™æ ·çš„ä¸€é¢—è§£ææ ‘ã€‚å³ä¾§è“è‰²éƒ¨åˆ†æ˜¯è¯¥è§£ææ ‘çš„â€œæ±‚å€¼è¿‡ç¨‹â€ï¼Œæ©™è‰²è™šçº¿è¿æ¥çš„æ˜¯æ ‘èŠ‚ç‚¹ï¼ˆå³éç»ˆç»“ç¬¦å®ä¾‹ï¼‰ä¸åœ¨å…¶èº«ä¸Šè§¦å‘çš„è¿è¡Œæ—¶è¯­ä¹‰ï¼Œæœ€å³è¾¹ç™½è‰²çš„ä»£ç å¯¹åº”ç€è¯¥éç»ˆç»“ç¬¦å®ä¾‹æ‰€åŒ…å«çš„ä»£ç æ–‡æœ¬ã€‚

![expression-evaluation-treeview](assets/algorithm/expression-evaluation-treeview.png)

ä»è¯­è¨€çš„è§’åº¦è®²ï¼Œå³è¾¹è“è‰²çš„è°ƒç”¨é“¾ï¼Œå°±æ˜¯è¿™æ¡è¡¨è¾¾å¼è¾“å‡ºè¯­ä¹‰çš„è¿‡ç¨‹ã€‚é€šè¿‡è§£ææ ‘çš„è§†è§’ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥â€œç”¨è‚‰çœ¼â€çœ‹åˆ°è¡¨è¾¾å¼Expressionæ±‚å€¼æ—¶ï¼Œé€—å·å·¦è¾¹è¡¨è¾¾å¼çš„é€’å½’è¿‡ç¨‹ã€‚

åœ¨è¿™æ¡è°ƒç”¨é“¾ä¸­ï¼Œæ‰€æœ‰è¡¨è¾¾å¼çš„æ±‚å€¼è¯­ä¹‰ï¼Œä½ éƒ½å¯ä»¥åœ¨æ ‡å‡†ä¸­æ‰¾åˆ°ï¼š

- èµ‹å€¼è¡¨è¾¾å¼AssignmentExpressionçš„[æ±‚å€¼è¯­ä¹‰](https://tc39.es/ecma262/multipage/ecmascript-language-expressions.html#sec-assignment-operators-runtime-semantics-evaluation)ã€‚
- æ›´æ–°è¡¨è¾¾å¼UpdateExpressionçš„[æ±‚å€¼è¯­ä¹‰](https://tc39.es/ecma262/multipage/ecmascript-language-expressions.html#sec-postfix-increment-operator-runtime-semantics-evaluation)ã€‚
- ä¸€å…ƒè¡¨è¾¾å¼UnaryExpressionçš„[æ±‚å€¼è¯­ä¹‰](https://tc39.es/ecma262/multipage/ecmascript-language-expressions.html#sec-unary-minus-operator)ã€‚

<br />

å¯¹äºå…³é”®çš„å†…å®¹ï¼Œæˆ‘å¾€å¾€ä¸ä¼šåªä¸¾ä¸€ä¸ªä¾‹å­ã€‚

è¿˜è®°å¾—æˆ‘ä»¬åœ¨[4.æ–‡æ³•åŸºç¡€](./4.context-free-grammar.md#æ–‡æ³•çš„åŸºæœ¬ç†è§£è§„åˆ™)ä¸­å¯¹classå£°æ˜è¯­å¥çš„æ–‡æ³•è¿›è¡Œäº†ä¸€æ¬¡å®Œå…¨çš„è§£æ„å—ï¼Ÿ

![ClassDeclaration-destructure](assets/context-free-grammar/ClassDeclaration-destructure.png)

ä½ å¯ä»¥åŒæ ·åœ¨æ ‡å‡†[classå£°æ˜è¯­å¥](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-class-definitions)ä¸€èŠ‚ï¼Œæ‰¾åˆ°æ‰€æœ‰classå£°æ˜è¯­å¥ç›¸å…³äº§ç”Ÿå¼æ‰€ç»‘å®šçš„è¿è¡Œæ—¶è¯­ä¹‰ï¼š(å¦‚ä¸‹å›¾çº¢è‰²æ¡†æ‰€ç¤ºï¼ŒRSæ˜¯Runtime Semanticsçš„ç¼©å†™)

![classDefinition-RS](assets/algorithm/classDefinition-RS.png)

æˆ‘æŠŠè¿™äº›è¿è¡Œæ—¶è¯­ä¹‰æ‰€ç»‘å®šçš„äº§ç”Ÿå¼ä»¥åŠä¸»è¦é€»è¾‘å¤§è‡´ä¸ºä½ æ€»ç»“ä¸€ä¸‹ï¼ˆç›®å½•ä»ä¸‹å¾€ä¸Šï¼‰ï¼š

| è¿è¡Œæ—¶è¯­ä¹‰çš„åç§°                                             | ç»‘å®šçš„äº§ç”Ÿå¼                                                 | ä¸»è¦é€»è¾‘                                                     |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| [Evaluation(æ±‚å€¼è¯­ä¹‰)](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-class-definitions-runtime-semantics-evaluation) | [ClassDeclaration](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassDeclaration)<br />[ClassExpression](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassExpression) | å¯åŠ¨åˆ›å»ºç±»çš„è¿‡ç¨‹                                             |
| [BindingClassDeclarationEvaluation](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-runtime-semantics-bindingclassdeclarationevaluation) | [ClassDeclaration](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassDeclaration) | æŠŠclassçš„æ ‡è¯†ç¬¦ï¼ˆç±»åï¼‰ç»‘å®šåœ¨ç¯å¢ƒä¸­                          |
| [ClassDefinitionEvaluation](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-runtime-semantics-classdefinitionevaluation) | [ClassTail](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassTail) | æ ¹æ®ClassTailï¼Œåˆ›å»ºæ„é€ å™¨å¯¹è±¡ä¸prototypeå¯¹è±¡                 |
| [ClassElementEvaluation](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-static-semantics-classelementevaluation) | [ClassElement](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassElement) | æ ¹æ®ClassElementçš„ç±»å‹ï¼Œåˆ†åˆ«åœ¨æ„é€ å™¨å¯¹è±¡ä¸prototypeå¯¹è±¡ä¸Šæ·»åŠ å±æ€§å’Œæ–¹æ³• |
| [EvaluateClassStaticBlockBody](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-runtime-semantics-evaluateclassstaticblockbody) | [ClassStaticBlockBody](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassStaticBlockBody) | æ‰§è¡Œclassé™æ€å—çš„é€»è¾‘                                        |
| [ClassStaticBlockDefinitionEvaluation](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-runtime-semantics-classstaticblockdefinitionevaluation) | [ClassStaticBlock](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassStaticBlock) | classé™æ€å—å…·ä½“çš„åˆ›å»ºè¿‡ç¨‹                                    |
| [ClassFieldDefinitionEvaluation](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-runtime-semantics-classfielddefinitionevaluation) | [FieldDefinition](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-FieldDefinition) | classå­—æ®µå…·ä½“çš„åˆ›å»ºè¿‡ç¨‹                                      |

ä»ä¸Šè¡¨æˆ‘ä»¬å¤§è‡´å¯ä»¥çŒœåˆ°ï¼šå½“åˆ›å»ºä¸€ä¸ªç±»æ—¶ï¼Œå°±æ˜¯é€šè¿‡è°ƒç”¨classå£°æ˜è¯­å¥ä¸­ï¼Œä¸åŒéƒ¨åˆ†å¯¹åº”çš„è¿è¡Œæ—¶è¯­ä¹‰å®Œæˆçš„ã€‚æ¯”å¦‚ï¼Œå½“æˆ‘å°è¯•é€šè¿‡ä»¥ä¸‹ä»£ç åˆ›å»ºä¸€ä¸ªç±»ï¼š

```js
class A {
  a;
  static {}
}
```

å…¶è§£æå¾—åˆ°çš„è§£ææ ‘ä»¥åŠè¿™äº›è¿è¡Œæ—¶è¯­ä¹‰çš„è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![class-runtimetime](assets/algorithm/class-runtimetime.png)

å¦‚æœä½ æƒ³é’»ç ”åˆ›å»ºç±»çš„å…·ä½“ç»†èŠ‚ï¼Œæœ‰ä¸¤ä¸ªæ–¹å¼ã€‚ä¸€æ˜¯ç›´æ¥é˜…è¯»æ ‡å‡†ä¸­åˆ›å»ºç±»çš„[æ±‚å€¼è¯­ä¹‰](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-class-definitions-runtime-semantics-evaluation)ï¼Œæ²¿ç€ç®—æ³•ç»™å‡ºäº¤å‰ç´¢å¼•ä½ å°†çœ‹åˆ°æ•´ä¸ªè¿‡ç¨‹è¿è¡Œæ—¶è¯­ä¹‰çš„è°ƒç”¨é“¾ä»¥åŠæ¯ä¸ªè¿è¡Œæ—¶è¯­ä¹‰çš„å…·ä½“é€»è¾‘ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯é˜…è¯»æœ¬ä¹¦åº”ç”¨ç¯‡çš„[15.ç±»](./15.class.md)ï¼Œå½“ç„¶ï¼Œæˆ‘ä¸ä¼šåƒæ ‡å‡†ä¸€æ ·åˆ—å‡ºæ‰€æœ‰ç»†èŠ‚ï¼Œæˆ‘åªæ˜¯æŠŠæ¯ä¸ªè¿‡ç¨‹çš„é‡è¦æ­¥éª¤ç»™ä½ åšä¸€ä¸ªæ€»ç»“ã€‚


<br/>


### é™æ€è¯­ä¹‰

**é™æ€è¯­ä¹‰ä¸€èˆ¬ç”¨äºå¯¹è¯­å¥åšä¸€äº›é™æ€å·¥ä½œï¼Œæ¯”å¦‚æ£€æŸ¥è¯­æ³•é”™è¯¯ã€åˆ¤æ–­è¯­å¥çš„ç±»å‹ã€æˆªå–è¯­å¥çš„æŸä¸ªéƒ¨åˆ†ä¾›å…¶ä»–è¯­ä¹‰ä½¿ç”¨ç­‰ç­‰**

ä»¥[è¯æ³•å£°æ˜è¯­å¥äº§ç”Ÿå¼LexicalDeclaration](https://tc39.es/ecma262/multipage/ecmascript-language-statements-and-declarations.html#prod-LexicalDeclaration)ç»‘å®šçš„ä¸€ä¸ªåä¸º[early-error](https://tc39.es/ecma262/multipage/ecmascript-language-statements-and-declarations.html#sec-let-and-const-declarations-static-semantics-early-errors)çš„é™æ€è¯­ä¹‰ä¸ºä¾‹ï¼Œè¿™ä¸ªè¯­ä¹‰ä¼šæ£€æŸ¥è¯­å¥è¯­æ³•æ˜¯å¦æœ‰é”™è¯¯ï¼š

![lexical-early-error](assets/algorithm/lexical-early-error.png)

ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œå½“ä¸€ä¸ªè¯æ³•å£°æ˜è¯­å¥å‡ºç°ä»¥ä¸‹çš„æƒ…å†µæ—¶ï¼Œä¼šæŠ›å‡ºè¯­æ³•é”™è¯¯ï¼ˆSyntax Errorï¼‰ï¼š

- å˜é‡ååŒ…å«"let"ï¼š

  ```js
  let let = 10
  ```

- é‡å¤å£°æ˜åŒä¸€å˜é‡ï¼š

  ```
  let a = 10, a = 100
  ```

- ä½¿ç”¨constæ¥è¿›è¡Œå£°æ˜ï¼Œä½†æ²¡æœ‰åˆå§‹åŒ–å˜é‡ï¼š

  ```
  const a
  ```

å®é™…ä¸Šï¼Œ**ã€Œå…ˆéªŒé”™è¯¯ï¼ˆearly-errorï¼‰ã€æ˜¯æœ€é‡è¦çš„é™æ€è¯­ä¹‰ã€‚** 

**å…ˆéªŒé”™è¯¯è¡¨ç¤ºé‚£äº›ä¸éœ€è¦æ‰§è¡Œä»£ç å°±èƒ½å¤Ÿå‘ç°çš„é”™è¯¯ã€‚åœ¨å¾—åˆ°è§£ææ ‘åï¼Œè§£ææ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šè¿›è¡Œå…ˆéªŒé”™è¯¯çš„æ£€æŸ¥ï¼Œåªæœ‰æ•´é¢—æ ‘éƒ½é€šè¿‡äº†æ£€éªŒï¼Œæ‰èƒ½å¼€å§‹æ‰§è¡ŒèŠ‚ç‚¹ä¸Šçš„æ±‚å€¼è¯­ä¹‰ã€‚å½“æ£€éªŒä¸é€šè¿‡çš„æ—¶å€™ï¼Œç¨‹åºä¼šä»¥è¯­æ³•é”™è¯¯SyntaxErroræå‰ç»ˆæ­¢ï¼Œå› æ­¤ä»£ç ä¸ä¼šè¿›å…¥æ‰§è¡Œé˜¶æ®µã€‚** 

å…ˆéªŒé”™è¯¯çš„å­˜åœ¨ï¼Œæ˜¯å› ä¸ºæœ‰æ—¶å€™æ–‡æ³•ä¸è¶³ä»¥å®Œå…¨è¦†ç›–è¯­è¨€ç»“æ„çš„æ‰€æœ‰é™åˆ¶ã€‚å°±å¥½æ¯”è‡ªç„¶è¯­è¨€ä¸­ï¼Œâ€œäººäººéƒ½èƒ½åƒæ ‡å‡†â€ã€â€œäººäººéƒ½èƒ½æ‹‰æ ‡å‡†â€ã€â€œäººäººéƒ½èƒ½åæ ‡å‡†â€ï¼Œæ˜¯ç»“æ„ä¸Šå®Œå…¨åˆæ³•çš„å¥å­ï¼Œä½†è¯­ä¹‰å®é™…ä¸Šæ˜¯ä¸é€šçš„ã€‚

ç”±äºå…ˆéªŒé”™è¯¯èƒ½å¤Ÿè¢«é™æ€æ£€æŸ¥ï¼Œä¸€äº›å¥½çš„ä»£ç ç¼–è¾‘å™¨ä¼šåœ¨ä½ ç¼–ç çš„æ—¶å€™å°±ä¸ºä½ æç¤ºè¿™äº›é”™è¯¯ï¼Œæ¯”å¦‚æˆ‘çš„vscodeï¼š

![early-error-vscode](assets/algorithm/early-error-vscode.png)

<br />

æˆ‘ä»¬ä»classå£°æ˜è¯­å¥çš„ç›®å½•ä¸­ï¼ŒåŒæ ·å¯ä»¥çœ‹åˆ°ä¸classæ–‡æ³•ç›¸å…³çš„é™æ€è¯­ä¹‰ï¼ˆSSä¸ºStatic Semanticsçš„ç¼©å†™ï¼‰ï¼š

![classDefinition-SS](assets/algorithm/classDefinition-SS.png)

ä¸‹è¡¨æˆ‘ä¸ºä½ æ€»ç»“å‡ºè¿™äº›é™æ€è¯­ä¹‰ç»‘å®šçš„äº§ç”Ÿå¼ä»¥åŠä»–ä»¬çš„ä¸»è¦é€»è¾‘ï¼Œä»ä¸­ä½ å¯ä»¥å¤§è‡´æ„Ÿå—åˆ°é™æ€è¯­ä¹‰ä¸»è¦çš„èŒè´£èŒƒå›´ã€‚åŒæ ·çš„ï¼Œä½ ä¹Ÿå¯ä»¥ç‚¹è¿›è¿™äº›é“¾æ¥ï¼Œé€šè¿‡æ ‡å‡†æä¾›çš„äº¤å‰ç´¢å¼•ï¼Œæ‰¾åˆ°è¿™äº›é™æ€è¯­ä¹‰è¢«è°ƒç”¨çš„ä½ç½®ã€‚

| é™æ€è¯­ä¹‰çš„åç§°                                               | ç»‘å®šçš„äº§ç”Ÿå¼                                                 | ä¸»è¦é€»è¾‘                                       |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ---------------------------------------------- |
| [Early Errorsï¼ˆå…ˆéªŒé”™è¯¯ï¼‰](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-class-definitions-static-semantics-early-errors) | [ClassTail](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassTail)ã€<br />[ClassBody](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassBody)ã€<br />[ClassElement](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassElement)ã€<br />[FieldDefinition](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-FieldDefinition)ã€<br />[ClassElementName](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassElementName)ã€<br />[ClassStaticBlockBody](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassStaticBlockBody) | åœ¨è¯­å¥å®é™…æ‰§è¡Œå‰æ£€æŸ¥æœ‰æ— è¯­æ³•é”™è¯¯               |
| [ClassElementKind](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-static-semantics-classelementkind) | [ClassElement](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassElement) | åˆ¤æ–­æŸä¸ªclasså…ƒç´ æ˜¯ä¸æ˜¯constructoræ–¹æ³•         |
| [ConstructorMethod](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-static-semantics-constructormethod) | [ClassElementList](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassElementList) | è·å–classå…ƒç´ åˆ—è¡¨ä¸­çš„constructoræ–¹æ³•           |
| [IsStatic](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-static-semantics-isstatic) | [ClassElement](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassElement) | åˆ¤æ–­æŸä¸ªclasså…ƒç´ æ˜¯ä¸æ˜¯é™æ€å…ƒç´                 |
| [NonConstructorElements](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-static-semantics-nonconstructorelements) | [ClassElementList](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassElementList) | è·å–classå…ƒç´ åˆ—è¡¨ä¸­æ‰€æœ‰éconstructoræ–¹æ³•çš„å…ƒç´  |
| [PrototypePropertyNameList](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-static-semantics-prototypepropertynamelist) | [ClassElementList](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassElementList) | è·å¾—prototypeå¯¹è±¡ä¸Šæ‰€æœ‰çš„å±æ€§å                |
| [AllPrivateIdentifiersValid](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-static-semantics-allprivateidentifiersvalid) | [ClassBody](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassBody) | åˆ¤æ–­æ‰€æœ‰çš„ç§æœ‰å±æ€§åæ˜¯å¦åˆæ³•                   |
| [PrivateBoundIdentifiers](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-static-semantics-privateboundidentifiers) | [ClassElementList](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-ClassElementList) | è·å¾—æ‰€æœ‰çš„ç§æœ‰å±æ€§å                           |
| [ContainsArguments](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-static-semantics-containsarguments) | [MethodDefinition](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-MethodDefinition) | åˆ¤æ–­classä¸Šçš„æ–¹æ³•æ˜¯å¦æœ‰å‚æ•°                    |


<br/>


### é“¾å¼äº§ç”Ÿå¼çš„è¯­æ³•å¯¼å‘æ“ä½œ

è¿˜è®°å¾—æˆ‘ä»¬å‰é¢è¯´çš„â€œå…¨æ ‡å‡†æœ€ç®€å•çš„è¯­æ³•å¯¼å‘æ“ä½œâ€å—ï¼Ÿæˆ‘ä»¬ç°åœ¨å·²ç»çŸ¥é“ï¼Œè¿™æ˜¯æ™®é€šè„šæœ¬Scriptä¸Šçš„ä¸€ä¸ªæ±‚å€¼è¯­ä¹‰ï¼Œä½†åªé€‚ç”¨äºè„šæœ¬ä¸ºç©ºçš„æƒ…å†µã€‚

é‚£ä¹ˆï¼Œå¦‚æœè„šæœ¬ä¸ä¸ºç©ºï¼Œå®ƒçš„æ±‚å€¼è¯­ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¾ˆå¯æƒœï¼Œä½ åœ¨æ ‡å‡†ä¸­æ‰¾ä¸åˆ°ä»»ä½•å…³äºéç©ºScriptæ±‚å€¼è¯­ä¹‰çš„å®šä¹‰ã€‚

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸å†å¼•å…¥ä¸€ä¸ªæ¦‚å¿µ â€”â€” **é“¾å¼äº§ç”Ÿå¼ï¼ˆchain productionï¼‰** ã€‚

**é“¾å¼äº§ç”Ÿå¼æŒ‡çš„æ˜¯å³ä¾§åªæœ‰å”¯ä¸€éç»ˆç»“ç¬¦çš„äº§ç”Ÿå¼ã€‚** æ¯”å¦‚ï¼Œæ™®é€šè„šæœ¬[ç›¸å…³çš„äº§ç”Ÿå¼](https://tc39.es/ecma262/multipage/ecmascript-language-scripts-and-modules.html#sec-scripts)å°±æ˜¯ä¸¤æ¡é“¾å¼äº§ç”Ÿå¼ï¼š

![chain-production-script](assets/algorithm/chain-production-script.png)

**é“¾å¼äº§ç”Ÿå¼æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼šå½“è§¦å‘äº§ç”Ÿå¼çš„æŸä¸ªè¯­æ³•å¯¼å‘æ“ä½œï¼Œä½†æ ‡å‡†æ²¡æœ‰å®šä¹‰å…¶å…·ä½“é€»è¾‘æ—¶ï¼Œä¼šéšå¼åœ°è§¦å‘äº§ç”Ÿå¼å³ç«¯é‚£ä¸ªå”¯ä¸€çš„éç»ˆç»“ç¬¦ä¸Šï¼ŒåŒåçš„è¯­æ³•å¯¼å‘æ“ä½œã€‚** 

æˆ‘ä»¬ä»¥ä¸€æ®µæ™®é€šè„šæœ¬çš„ä»£ç ä¸ºä¾‹ï¼š

```js
let a = 1;
a++;
console.log(a)
```

å¯¹è¿™æ®µä»£ç è¿›è¡Œè¯­æ³•è§£æï¼Œç„¶åè°ƒç”¨Scriptçš„æ±‚å€¼è¯­ä¹‰ï¼Œè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![chain-production-example](assets/algorithm/chain-production-example.png)

ä½¿ç”¨è¯­è¨€è¡¨è¿°çš„è¯ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š

1. ç”±äºæ ‡å‡†ä¸­æ²¡æœ‰å®šä¹‰æ™®é€šè„šæœ¬Scriptï¼ˆä¸ä¸ºç©ºæ—¶ï¼‰çš„æ±‚å€¼è¯­ä¹‰ï¼ŒåŸºäºé“¾å¼äº§ç”Ÿå¼çš„ç‰¹ç‚¹ï¼Œ[è„šæœ¬ä½“ScriptBody]()çš„æ±‚å€¼è¯­ä¹‰ä¼šè¢«è§¦å‘ã€‚

2. ç”±äºæ ‡å‡†ä¹Ÿæ²¡æœ‰å®šä¹‰è„šæœ¬ä½“çš„æ±‚å€¼è¯­ä¹‰ï¼ŒåŸºäºé“¾å¼äº§ç”Ÿå¼çš„ç‰¹ç‚¹ï¼Œ[è¯­å¥åˆ—è¡¨StatementList](https://tc39.es/ecma262/multipage/ecmascript-language-statements-and-declarations.html#prod-StatementList)çš„æ±‚å€¼è¯­ä¹‰ä¼šè¢«è§¦å‘ã€‚

3. æ ¹æ®è¯­å¥åˆ—è¡¨çš„æ±‚å€¼è¯­ä¹‰ï¼Œè¯­å¥ä¼šä¾æ¬¡è¢«æ‰§è¡Œï¼š

   ![statementList-evaluation](assets/algorithm/statementList-evaluation.png)

StatementListçš„æ±‚å€¼è¯­ä¹‰æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„è¿è¡Œæ—¶è¯­ä¹‰ï¼Œå› ä¸ºå®ƒæ„æˆäº†[è„šæœ¬ä½“ScriptBody](https://tc39.es/ecma262/multipage/ecmascript-language-scripts-and-modules.html#prod-ScriptBody)ã€[å‡½æ•°ä½“FunctionBody](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#prod-FunctionBody)ã€[å—è¯­å¥Block](https://tc39.es/ecma262/multipage/ecmascript-language-statements-and-declarations.html#prod-Block)çš„ä¸»ä½“ï¼Œå¯¹Scriptã€FunctionBodyã€Blockçš„æ±‚å€¼æœ€ç»ˆéƒ½ä¼šå¯¼å‘å¯¹å®ƒçš„æ±‚å€¼ã€‚åœ¨[7.è§„èŒƒç±»å‹](./7.spec_type.md)ä¸­ï¼Œæˆ‘ä»¬ä¼šå†å¯¹è¿™ä¸ªæ±‚å€¼è¯­ä¹‰è¿›è¡Œæ›´åŠ æ·±å…¥çš„ç ”ç©¶ã€‚

<br />

ä»¥ä¸Šï¼Œå°±æ˜¯å…³äºç®—æ³•ç±»å‹çš„å…¨éƒ¨å†…å®¹ã€‚å‰©ä½™çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¼šå¯¹ç®—æ³•çš„ç¬¦å·è¡¨ç¤ºè¿›è¡Œå®Œå…¨çš„è§£å‰–ã€‚


<br/>


## ç®—æ³•çš„è¡¨ç¤ºçº¦å®š

ä»ä¸Šé¢æ‹†ç®±è½¬æ¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥çœ‹åˆ°ä¸€äº›åŸºç¡€ç¬¦å·çš„ä½¿ç”¨è§„åˆ™ï¼š

![notation-basic](assets/algorithm/notation-basic.png)

- ä½¿ç”¨æ ‡å·è¡¨ç¤ºæ­¥éª¤é¡ºåºï¼Œå¹¶ä¸”æŒ‰ç…§ã€Œæ•´æ•° - è‹±æ–‡å­—æ¯ - ç½—é©¬æ•°å­—ã€çš„æ ‡å·é¡ºåºè¡¨ç¤ºä¸åŒå±‚çº§çš„ç®—æ³•ã€‚å®é™…ä¸Šï¼Œå¦‚æœå­ç®—æ³•åµŒå¥—è¶…è¿‡ä¸‰å±‚ï¼Œä¼šå¾ªç¯ä½¿ç”¨è¿™ä¸ªæ ‡å·é¡ºåºï¼›

- é€šè¿‡â€œlet x be yâ€è¡¨ç¤ºç»™xèµ‹äºˆyå€¼ã€‚

- é€šè¿‡ifã€Elseè¡¨ç¤ºæ¡ä»¶è¯­å¥ï¼›Forè¡¨ç¤ºéå†è¯­å¥ï¼›æ ‡å‡†è¿˜ä¼šç”¨Repeatè¡¨ç¤ºå¾ªç¯è¯­å¥ã€‚

- æ‰€æœ‰è¯­è¨€ç±»å‹ï¼Œéƒ½ä¼šä»¥åŠ ç²—çš„æ–¹å¼è¡¨ç¤ºã€‚æ¯”å¦‚è¿™é‡Œçš„å‡½æ•°ï¼ˆ`tostring`ä¸`valueof`ï¼‰ã€å¸ƒå°”å€¼ï¼ˆ`true`ï¼‰ã€å¯¹è±¡ï¼ˆ`TypeError`ï¼‰éƒ½è¿›è¡Œäº†åŠ ç²—ï¼›


<br />

å…¶ä»–ä¸€äº›é‡è¦çš„è¡¨ç¤ºè§„åˆ™å¦‚ä¸‹ï¼š

- å¯é€‰å‚æ•°ä½¿ç”¨`[]`è¡¨ç¤ºï¼Œå¦‚æ‹†ç®±è½¬æ¢ä¸­ï¼Œ[Callç®—æ³•](https://tc39.es/ecma262/multipage/abstract-operations.html#sec-call)çš„å®šä¹‰ï¼š![call-arg](assets/algorithm/call-arg.png)

- `Assert: `è¡¨ç¤ºå½“ç®—æ³•æ‰§è¡Œåˆ°è¿™ä¸€æ­¥çš„æ—¶å€™ï¼Œå…¶åé¢çš„è¯­å¥å¿…é¡»ä¸ºçœŸï¼Œä»»ä½•æœ‰å¯¼è‡´å‡çš„æƒ…å†µéƒ½æ˜¯æ ‡å‡†çš„ç¼–å†™é”™è¯¯ã€‚ä½¿ç”¨`Assert: `çš„ç›®çš„æ˜¯å¢åŠ ç®—æ³•çš„å¯è¯»æ€§ã€‚

  ![assert-example](assets/algorithm/assert-example.png)
  
- å›ºæœ‰å¯¹è±¡ä½¿ç”¨`%%`è¡¨ç¤ºã€‚å›ºæœ‰å¯¹è±¡æ˜¯æ ‡å‡†å®šä¹‰çš„å†…ç½®å¯¹è±¡ï¼Œå›ºæœ‰å¯¹è±¡å¸¸å¸¸åœ¨ç®—æ³•ä¸­ä½œä¸ºåŸå‹æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚æ¯”å¦‚ï¼Œåœ¨åˆ›å»ºç±»çš„è¿è¡Œæ—¶è¯­ä¹‰[ClassDefinitionEvaluation](https://tc39.es/ecma262/multipage/ecmascript-language-functions-and-classes.html#sec-runtime-semantics-classdefinitionevaluation)ä¸­ï¼š

  ![intrinsic-notation](assets/algorithm/intrinsic-notation.png)

  

<br />
<br/>


### ç®—æ³•ä¸­çš„æ•°å­—

å¯ä»¥æŠŠç®—æ³•ä¸­çš„æ•°å­—åˆ†æˆä¸‰ç±»ï¼š

1. Numberç±»å‹çš„æ•°å­—ï¼šä½¿ç”¨`ğ”½ `çš„ä¸‹æ ‡ï¼›

2. BigIntsç±»å‹çš„æ•°å­—ï¼šä½¿ç”¨`â„¤`çš„ä¸‹æ ‡ï¼›

3. æ ‡å‡†ç®—æ³•å†…éƒ¨ä½¿ç”¨çš„æ•°å­—ï¼šæ²¡æœ‰ç‰¹å®šçš„ä¸‹æ ‡ã€‚

è¿™ä¹ˆåšçš„åŸå› æ˜¯ï¼Œä¸åŒç±»å‹çš„æ•°å­—åœ¨é‡åˆ°è¿ç®—ç¬¦ï¼ˆå¦‚åŠ å‡ä¹˜é™¤ã€å¤§äºå°äºï¼‰æ—¶ï¼Œä¼šè°ƒç”¨ä¸åŒçš„ç®—æ³•ã€‚ç¬¬ä¸‰ç§æ•°å­—ç±»å‹åªä¼šåœ¨ç®—æ³•å†…éƒ¨ä½¿ç”¨ï¼Œç¨‹åºæ— æ³•æ•è·åˆ°ï¼Œ

è¿™äº›æ•°å­—ç±»å‹ä¹‹é—´æ˜¯å¯ä»¥äº’ç›¸è½¬æ¢çš„ã€‚æ ‡å‡†ä¼šä½¿ç”¨`ğ”½(x)`è¡¨ç¤ºæŠŠxè½¬åŒ–ä¸ºNumberç±»å‹ï¼Œä½¿ç”¨` â„¤(x)`è¡¨ç¤ºæŠŠxè½¬åŒ–ä¸ºbigIntï¼Œä½¿ç”¨`â„(x)`è¡¨ç¤ºæŠŠxè½¬åŒ–ä¸ºç®—æ³•å†…éƒ¨ä½¿ç”¨çš„æ•°å­—ã€‚

ä»¥æŠ½è±¡æ“ä½œ[ToIntegerOrInfinity](https://tc39.es/ecma262/multipage/abstract-operations.html#sec-tointegerorinfinity)ä¸ºä¾‹ï¼Œè¿™ä¸ªæŠ½è±¡æ“ä½œä¼šæŠŠå‚æ•°è½¬åŒ–ä¸ºï¼ˆç¬¬ä¸‰ç§ï¼‰ç®—æ³•æ•°å­—ç±»å‹ï¼Œè½¬åŒ–çš„ç»“æœä¼šç»™æ ‡å‡†å…¶ä»–çš„ç®—æ³•ä½¿ç”¨ã€‚

![ToIntegerOrInfinity](assets/algorithm/ToIntegerOrInfinity.png)

æŠŠè¿™ä¸ªæŠ½è±¡æ“ä½œçš„å…·ä½“é€»è¾‘è½¬åŒ–ä¸ºä¸­æ–‡å¦‚ä¸‹ï¼š

> 1. é€šè¿‡æŠ½è±¡æ“ä½œ[ToNumber](https://tc39.es/ecma262/multipage/abstract-operations.html#sec-tonumber)ï¼ŒæŠŠå‚æ•°è½¬åŒ–ä¸ºæ•°å­—ï¼Œèµ‹å€¼åœ¨å˜é‡`number`ä¸Šï¼ˆæ­¤æ—¶`number`æ˜¯ä¸€ä¸ªNumberç±»å‹ï¼‰
> 2. å¦‚æœ`number`æ˜¯NaNã€+0ğ”½, or -0ğ”½å…¶ä¸­ä¹‹ä¸€ï¼Œè¿”å›0ã€‚
> 3. å¦‚æœ`number`æ˜¯+âˆğ”½ï¼Œè¿”å›+âˆ
> 4. å¦‚æœ`number`æ˜¯-âˆğ”½ï¼Œè¿”å›-âˆ
> 5. æŠŠ`number`è½¬åŒ–ä¸ºç®—æ³•æ•°å­—ç±»å‹ï¼Œå¹¶é€šè¿‡æŠ½è±¡æ“ä½œ[truncate](https://tc39.es/ecma262/multipage/notational-conventions.html#eqn-truncate)ç§»é™¤æ‰å°æ•°ç‚¹åé¢çš„éƒ¨åˆ†ã€‚


<br/>


### ç®—æ³•ä¸­çš„è§„èŒƒç±»å‹

æ­£å¦‚ç®—æ³•æœ‰å†…éƒ¨è‡ªç”¨çš„æ•°å­—ç±»å‹ï¼Œç®—æ³•ä¹Ÿæœ‰å…¶å†…éƒ¨è‡ªç”¨çš„æ•°æ®ç±»å‹ï¼Œç§°ä¸ºã€Œè§„èŒƒç±»å‹ã€ã€‚è§„èŒƒç±»å‹å°†åœ¨[ä¸‹ä¸€èŠ‚](./7.spec_type.md)è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å…ˆç»™å‡ºè¿™äº›è§„èŒƒç±»å‹åœ¨ç®—æ³•ä¸­çš„æ ‡æ³¨æ–¹å¼ï¼š

| è§„èŒƒç±»å‹         | æ ‡æ³¨æ–¹å¼ä¾‹å­ï¼ˆä½¿ç”¨ç¬¦å·æˆ–ç‰¹å®šå­—ä½“ï¼‰                       |
| ---------------- | -------------------------------------------------------- |
| Enum             | ä½¿ç”¨`sans-serif`å­—ä½“è¡¨ç¤º                                 |
| Listï¼ˆåˆ—è¡¨ï¼‰     | Â« 1, 2 Â»                                                 |
| Recordï¼ˆè®°å½•å™¨ï¼‰ | { [[Field1]]: 42, [[Field2]]: false, [[Field3]]: empty } |
| Data Block       | db[2]                                                    |

ä¸ç®¡æ˜¯åœ¨[Expressionè¡¨è¾¾å¼](https://tc39.es/ecma262/multipage/ecmascript-language-expressions.html#sec-comma-operator-runtime-semantics-evaluation)ã€è¿˜æ˜¯StatementListè¯­å¥çš„æ±‚å€¼è¯­ä¹‰ï¼Œä½ éƒ½çœ‹åˆ°ç®—æ³•æ­¥éª¤ä¸­å¸¦æœ‰ä¸€äº›é—®å·`?`ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€æ®µç§°ä¸º[ReturnIfAbrupt](https://tc39.es/ecma262/multipage/notational-conventions.html#sec-returnifabrupt)çš„é€»è¾‘çš„ç®€å†™ã€‚å®ƒè¡¨ç¤ºå¦‚æœå­ç®—æ³•çš„æ‰§è¡Œå‡ºç°é”™è¯¯ï¼Œæˆ–è€…éœ€è¦è¿›è¡Œè·³è½¬ï¼ˆå¦‚æ‰§è¡Œbreakè¯­å¥ï¼‰ï¼Œåˆ™ç»ˆæ­¢æ•´ä¸ªä¸»ç®—æ³•åç»­çš„æ‰§è¡Œå¹¶ç›´æ¥è¿”å›å­ç®—æ³•çš„æ‰§è¡Œç»“æœã€‚

æ¯”å¦‚ï¼ŒExpressionæ±‚å€¼è¯­ä¹‰çš„ç¬¬ä¸€æ­¥ï¼š

> 1. Let lref be ? [Evaluation](https://tc39.es/ecma262/multipage/syntax-directed-operations.html#sec-evaluation) of [Expression](https://tc39.es/ecma262/multipage/ecmascript-language-expressions.html#prod-Expression).

ç›¸å½“äºï¼š

> 1. Let lref be ReturnIfAbrupt([Evaluation](https://tc39.es/ecma262/multipage/syntax-directed-operations.html#sec-evaluation) of [Expression](https://tc39.es/ecma262/multipage/ecmascript-language-expressions.html#prod-Expression)).

å®ƒçš„å«ä¹‰æ˜¯ï¼šå¦‚æœé€—å·å·¦è¾¹çš„è¡¨è¾¾å¼æ‰§è¡Œå‡ºç°é”™è¯¯ï¼Œåé¢çš„è¡¨è¾¾å¼å°±ä¸ä¼šå†æ‰§è¡Œäº†ã€‚å¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºï¼š

```js
((throw "new"), console.log(1))// 1ä¸ä¼šè¾“å‡º
```

ReturnIfAbruptçš„å…·ä½“é€»è¾‘ç»†èŠ‚ä¸ä¸€ç§åä¸º[å®Œæˆè®°å½•å™¨](https://tc39.es/ecma262/multipage/ecmascript-data-types-and-values.html#sec-completion-record-specification-type)çš„è§„èŒƒç±»å‹æœ‰ç€ç´§å¯†çš„å…³ç³»ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šåœ¨è§„èŒƒç±»å‹çš„ç« èŠ‚ä¸­å†ä½œå±•å¼€ã€‚

è¿˜æœ‰å¦ä¸€ä¸ªæ¯”è¾ƒå°‘è§çš„ç¬¦å·æ˜¯æ„Ÿå¹å·`!`ï¼Œ`!`è¡¨ç¤ºåé¢çš„å­ç®—æ³•ä¸ä¼šå‡ºç°é”™è¯¯ï¼Œä¹Ÿä¸ä¼šéœ€è¦è·³è½¬ï¼ŒåŠŸèƒ½ä¸`Assert: `ç±»ä¼¼ã€‚





